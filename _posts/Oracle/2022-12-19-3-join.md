---
title: "[Oracle] SQL문법 4.집합 연산자와 JOIN"
excerpt: "UNION, JOIN 등 SQL 기본 문법"

categories:
  - Oracle
tags:
  - [Oracle, SQL]

comments: true
toc: true
toc_sticky: true

date: 2020-12-19
last_modified_at: 2020-12-19
---

## 집합 연산자(SET OPERATOR)

> ### 집합 연산자란

- 여러개의 쿼리문을(=SELECT 결과물) 가지고 하나의 쿼리문으로 만드는 연산자이다
- 여러개의 SELECT문을 하나로 연결한다
- 집합 연산자로 결합된 컬럼의 결과 컬럼 또한 데이터타입이 동일해야 한다
- 양 쿼리문의 결과를 합쳐서 한개의 테이블로 보여줘야 하기 때문에 각 쿼리문의 SELECT절 부분이 같아야 한다  
  => 조회할 <u>컬럼이 동일</u>해야 한다

<br>

#### [ UNION ]

```sql
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE DEPT_CODE = ‘D5’ -- 6명 조회됨
UNION
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE SALARY > 3000000; -- 8명 조회됨
-- 하지만 중복값이 제거되어 총 14명이 아닌, 6명이 출력된다
```

- 합집합
- 여러개의 쿼리 결과를 합치는 연산자로 중복된 영역은 제외한다  
  => 두 쿼리문의 수행 결과를 합친 후 중복값을 한번 제거한다
- 자주 사용하는 것을 권장하지 않는다

<br>

#### [ UNION ALL ]

```sql
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE DEPT_CODE = ‘D5’ -- 6명 조회됨
UNION ALL
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE SALARY > 3000000; -- 8명 조회됨
-- 중복값을 제외하지 않아, 둘을 더한 값인 총 14명이 출력된다
```

- 합집합 + 교집합
- 여러 쿼리 결과를 합치는 연산자로 중복된 영역 모두 포함하여 합친다  
  => 중복 제거를 하지 않는다

<br>

#### [ INTERSECT ]

```sql
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE DEPT_CODE = ‘D5’ -- 6명 조회됨
INTERSECT
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE SALARY > 3000000; -- 8명 조회됨
-- 두 쿼리의 중복되는 부분인 총 2명이 출력된다
```

- 교집합
- 여러 쿼리 결과의 중복된 결과만 추출한다
- EXISTS 또는 IN 서브쿼리를 이용한 SQL문으로 변경 가능하다

<br>

#### [ MINUS ]

```sql
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE DEPT_CODE = ‘D5’ -- 6명 조회됨
MINUS
SELECT EMP_ID, EMP_NAME, DEPT_CODE, SALARY
FROM EMPLOYEE
WHERE SALARY > 3000000; -- 8명 조회됨
-- 선행쿼리문에서 후행쿼리문과 중복되는 부분인 2명을 뺀 4명이 출력된다
```

- 차집합
- 선행 쿼리문 결과값에서 후행 쿼리문 결과값을 뺀 나머지 부분을 추출한다  
  => 선행 쿼리문 결과값 - 교집합(1회)
- NOT EXISTS 또는 NOT IN 서브 쿼리를 이용한 SQL문으로 변경 가능하다

<br>

## JOIN

> ### JOIN이란

- 두개 이상의 테이블에서 데이터를 함께 조회하고자 할 때 사용되는 구문이다
- 수행결과는 하나의 결과물(Result Set)으로 나오게 된다
- 사용 목적
  - 관계형 데이터베이스에서는 최소한의 데이터로
